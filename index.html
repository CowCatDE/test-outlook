<!DOCTYPE html>
<html>
<head>
    <title>Outlook Add-In</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
        Office.onReady(function (info) {
            // Office ist bereit
            console.log('Office ist bereit:', info);
            
            if (info.host === Office.HostType.Outlook) {
                console.log('Outlook Add-In geladen');

                // Button und Event Listener für das Abrufen der Empfänger
                document.getElementById("loadRecipientsButton").addEventListener("click", function () {
                    // Empfänger-Datenstruktur
                    const recipients = {
                        to: [],
                        cc: [],
                        bcc: []
                    };

                    // Abrufen der 'To'-Empfänger
                    Office.context.mailbox.item.getAsync(function(result) {
                        var htmlContent = document.getElementById('htmlContent').value;
                        if (item) {
                          item.body.setAsync(htmlContent, { coercionType: "html" }, function(result) {
                            if (result.status === "succeeded") {
                              // Sende die E-Mail
                              item.sendAsync(function(sendResult) {
                                if (sendResult.status === "succeeded") {
                                  console.log("E-Mail gesendet!");
                                } else {
                                  console.error("Fehler beim Senden der E-Mail: " + sendResult.error.message);
                                }
                              });
                            } else {
                              console.error("Fehler beim Setzen des HTML-Inhalts: " + result.error.message);
                            }
                          });
                        } else {
                          console.error("Kein E-Mail-Element gefunden.");
                        }
                    });
                });
            }
        });
    </script>
</head>
<body>
    <h1>Outlook Add-In</h1>
    <p>Dieses Add-In zeigt Empfängerinformationen an.</p>

    <textarea id="htmlContent" rows="10" cols="50"></textarea><br>

    <!-- Button zum Abrufen und Anzeigen der Empfänger -->
    <button id="loadRecipientsButton">Empfänger anzeigen</button>

    <!-- Div zur Anzeige der Empfänger als JSON -->
    <div id="recipientsDiv" style="white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; margin-top: 20px;">
        <!-- Hier wird das JSON angezeigt -->
    </div>
</body>
</html>
