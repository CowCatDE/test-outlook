<!DOCTYPE html>
<html>
<head>
  <title>HTML E-Mail senden</title>
</head>
<body>
  <h2>HTML-Code eingeben</h2>

  <!-- Textarea für HTML-Code -->
  <textarea id="htmlContent" rows="10" cols="50"></textarea><br>
  <button id="sendButton">Senden</button>

  <script type="text/javascript">
    Office.initialize = function() {
      // Initialisierung des Add-Ins (optional)
    };

    // Wenn der Senden-Button geklickt wird
    document.getElementById('sendButton').onclick = function() {
      // Hole den HTML-Code aus dem Textbereich
      var htmlContent = document.getElementById('htmlContent').value;

      // Rufe die E-Mail-Daten (Empfänger, Betreff etc.) aus dem Outlook-Editor ab
      var item = Office.context.mailbox.item;

      // Überprüfen, ob das Add-In auf einem E-Mail-Item geöffnet wurde
      if (item) {
        // Setze den HTML-Inhalt des E-Mail-Bodys auf den eingegebenen HTML-Code
        item.body.setAsync(htmlContent, { coercionType: "html" }, function(result) {
          if (result.status === "succeeded") {
            // Sende die E-Mail
            item.sendAsync(function(sendResult) {
              if (sendResult.status === "succeeded") {
                console.log("E-Mail gesendet!");
              } else {
                console.error("Fehler beim Senden der E-Mail: " + sendResult.error.message);
              }
            });
          } else {
            console.error("Fehler beim Setzen des HTML-Inhalts: " + result.error.message);
          }
        });
      } else {
        console.error("Kein E-Mail-Element gefunden.");
      }
    };
  </script>
</body>
</html>
